(this["webpackJsonpros-phone-sensors-app"]=this["webpackJsonpros-phone-sensors-app"]||[]).push([[0],{39:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var i=n(2),o=n(4),a=n.n(o),s=n(32),r=n.n(s),c=(n(39),n(19)),l=n(33),h=n.n(l),u=n(0),v=n(1),d=n(8),g=n.n(d),m=n(18),p=function(){function e(t){Object(u.a)(this,e),this.ros=void 0,this.alpha=void 0,this.valpha=void 0,this.z=void 0,this.beta=void 0,this.vbeta=void 0,this.x=void 0,this.gamma=void 0,this.vgamma=void 0,this.y=void 0,this.is_mobile=void 0,this.image_topic=void 0,this.imu_topic=void 0,this.is_mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t="wss://".concat(t,":9090"),console.log(t),this.ros=new g.a.Ros({url:t}),this.ros.on("connection",(function(){console.log("Connected to websocket server.")})),this.ros.on("error",(function(e){console.log("Error connecting to websocket server: ",e),window.alert("Error connecting to websocket server")})),this.ros.on("close",(function(){console.log("Connection to websocket server closed.")})),this.alpha=null,this.valpha=null,this.z=null,this.beta=null,this.vbeta=null,this.x=null,this.gamma=null,this.vgamma=null,this.y=null,this.image_topic=new g.a.Topic({ros:this.ros,name:"/camera/image/compressed",messageType:"sensor_msgs/CompressedImage"}),this.imu_topic=new g.a.Topic({ros:this.ros,name:"/gyro",messageType:"sensor_msgs/Imu"}),this.is_mobile&&this.initialize_event_handlers()}return Object(v.a)(e,[{key:"initialize_event_handlers",value:function(){var e=this;"https:"!==window.location.protocol&&(window.location.href="https:"+window.location.href.substring(window.location.protocol.length)),"undefined"!==typeof DeviceOrientationEvent&&"function"===typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(t){"granted"===t&&window.addEventListener("deviceorientation",(function(t){e.gamma=t.gamma,e.beta=t.beta,e.alpha=t.alpha}),!1)})).catch(console.error):alert("DeviceOrientationEvent is not defined"),"undefined"!==typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(t){"granted"===t&&window.addEventListener("devicemotion",(function(t){var n=t.acceleration;e.x=n.x,e.y=n.y,e.z=n.z;var i=t.rotationRate;e.valpha=i.alpha,e.vgamma=i.gamma,e.vbeta=i.beta}),!1)})).catch(console.error):alert("DeviceMotionEvent is not defined")}},{key:"imageSnapshot",value:function(e){var t=new g.a.Message({format:"jpeg",data:e().replace("data:image/jpeg;base64,","")});this.image_topic.publish(t)}},{key:"imuSnapshot",value:function(){var e=(this.beta+360)/360*2*Math.PI%(2*Math.PI),t=(this.gamma+360)/360*2*Math.PI%(2*Math.PI),n=(this.alpha+360)/360*2*Math.PI%(2*Math.PI),i=new m.a(e,t,n),o=new m.b;o.setFromEuler(i);var a=new g.a.Message({header:{frame_id:"world"},orientation:{x:o.x,y:o.y,z:o.z,w:o.w},orientation_covariance:[0,0,0,0,0,0,0,0,0],angular_velocity:{x:this.vbeta,y:this.vgamma,z:this.valpha},angular_velocity_covariance:[0,0,0,0,0,0,0,0,0],linear_acceleration:{x:this.x,y:this.y,z:this.z},linear_acceleration_covariance:[0,0,0,0,0,0,0,0,0]});this.imu_topic.publish(a)}},{key:"start",value:function(e){var t=this;setInterval((function(){t.imageSnapshot(e)}),250),this.is_mobile&&setInterval((function(){t.imuSnapshot()}),100)}}]),e}();var b=function(){var e=Object(o.useState)(""|window.localStorage.getItem("rosMasterIp")),t=Object(c.a)(e,2),n=t[0],a=t[1],s=Object(o.useState)(!1|window.localStorage.getItem("frontFacing")),r=Object(c.a)(s,2),l=r[0],u=r[1];window.localStorage.setItem("frontFacing",l);var v=window.screen.width-20,d=.65*window.screen.height,g={width:1920,height:1080},m={width:v,height:d,facingMode:l?"user":{exact:"environment"}},b=Object(o.useRef)(null),w=function(){if(b){var e=b.current.getScreenshot(g);if(e)return e;window.alert("Camera not accessible!")}};return Object(i.jsxs)("div",{style:{padding:"".concat(10,"px")},children:[Object(i.jsx)("label",{children:"ROS Master IP Address:"}),Object(i.jsx)("input",{onChange:function(e){window.localStorage.setItem("rosMasterIp",e.target.value),console.log(e.target.value),a(e.target.value)},value:n}),Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),Object(i.jsx)("button",{onClick:function(){return function(){try{new p(n).start(w)}catch(e){window.alert("An error has occured: ".concat(e))}}()},children:"Initialize"}),Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),Object(i.jsx)("label",{children:"Front Facing Camera? "}),Object(i.jsx)("input",{onChange:function(){window.localStorage.setItem("frontFacing",!l),u(!l)},value:l,type:"checkbox"}),Object(i.jsx)("div",{}),Object(i.jsx)(h.a,{audio:!1,height:d,ref:b,screenshotFormat:"image/jpeg",width:v,videoConstraints:m})]})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,62)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),i(e),o(e),a(e),s(e)}))};r.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(b,{})}),document.getElementById("root")),w()}},[[61,1,2]]]);
//# sourceMappingURL=main.8a73e857.chunk.js.map