(this["webpackJsonpros-phone-sensors-app"]=this["webpackJsonpros-phone-sensors-app"]||[]).push([[0],{39:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(2),i=a(4),o=a.n(i),s=a(32),r=a.n(s),c=(a(39),a(19)),h=a(33),l=a.n(h),u=a(0),v=a(1),g=a(8),d=a.n(g),m=a(18),p=function(){function e(t){Object(u.a)(this,e),this.ros=void 0,this.alpha=void 0,this.valpha=void 0,this.z=void 0,this.beta=void 0,this.vbeta=void 0,this.x=void 0,this.gamma=void 0,this.vgamma=void 0,this.y=void 0,this.image_topic=void 0,this.imu_topic=void 0,t="ws://"+t+":9090",this.ros=new d.a.Ros({url:t}),this.ros.on("connection",(function(){console.log("Connected to websocket server.")})),this.ros.on("error",(function(e){console.log("Error connecting to websocket server: ",e),window.alert("Error connecting to websocket server")})),this.ros.on("close",(function(){console.log("Connection to websocket server closed.")})),this.alpha=null,this.valpha=null,this.z=null,this.beta=null,this.vbeta=null,this.x=null,this.gamma=null,this.vgamma=null,this.y=null,this.image_topic=new d.a.Topic({ros:this.ros,name:"/camera/image/compressed",messageType:"sensor_msgs/CompressedImage"}),this.imu_topic=new d.a.Topic({ros:this.ros,name:"/gyro",messageType:"sensor_msgs/Imu"}),this.initialize_event_handlers()}return Object(v.a)(e,[{key:"initialize_event_handlers",value:function(){var e=this;window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",(function(t){e.gamma=t.gamma,e.beta=t.beta,e.alpha=t.alpha}),!1),window.DeviceMotionEvent?window.addEventListener("devicemotion",(function(t){var a=t.acceleration;e.x=a.x,e.y=a.y,e.z=a.z;var n=t.rotationRate;e.valpha=n.alpha,e.vgamma=n.gamma,e.vbeta=n.beta}),!1):window.alert("acceleration measurements Not supported.")}},{key:"imageSnapshot",value:function(e){var t=new d.a.Message({format:"jpeg",data:e().replace("data:image/jpeg;base64,","")});this.image_topic.publish(t)}},{key:"imuSnapshot",value:function(){var e=(this.beta+360)/360*2*Math.PI%(2*Math.PI),t=(this.gamma+360)/360*2*Math.PI%(2*Math.PI),a=(this.alpha+360)/360*2*Math.PI%(2*Math.PI),n=new m.a(e,t,a),i=new m.b;i.setFromEuler(n);var o=new d.a.Message({header:{frame_id:"world"},orientation:{x:i.x,y:i.y,z:i.z,w:i.w},orientation_covariance:[0,0,0,0,0,0,0,0,0],angular_velocity:{x:this.vbeta,y:this.vgamma,z:this.valpha},angular_velocity_covariance:[0,0,0,0,0,0,0,0,0],linear_acceleration:{x:this.x,y:this.y,z:this.z},linear_acceleration_covariance:[0,0,0,0,0,0,0,0,0]});this.imu_topic.publish(o)}},{key:"start",value:function(e){var t=this;setInterval((function(){t.imageSnapshot(e)}),250),setInterval((function(){t.imuSnapshot()}),100)}}]),e}();var b=function(){var e=Object(i.useState)(""|localStorage.getItem("rosMasterIp")),t=Object(c.a)(e,2),a=t[0],o=t[1],s=Object(i.useState)(!0|localStorage.getItem("frontFacing")),r=Object(c.a)(s,2),h=r[0],u=r[1],v=window.screen.width-20,g=.65*window.screen.height,d={width:1920,height:1080},m={width:v,height:g,facingMode:h?"user":{exact:"environment"}},b=Object(i.useRef)(null),j=function(){if(b)return b.current.getScreenshot(d)};return Object(n.jsxs)("div",{style:{padding:"".concat(10,"px")},children:[Object(n.jsx)("label",{children:"ROS Master IP Address:"}),Object(n.jsx)("input",{onChange:function(e){localStorage.setItem("rosMasterIp",e.target.value),o(e.target.value)}}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),Object(n.jsx)("button",{onClick:function(){new p(a).start(j)},children:"Initialize"}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),Object(n.jsx)("label",{children:"Front Facing Camera? "}),Object(n.jsx)("input",{onChange:function(){localStorage.setItem("frontFacing",!h),u(!h)},type:"checkbox"}),Object(n.jsx)("div",{}),Object(n.jsx)(l.a,{audio:!1,height:g,ref:b,screenshotFormat:"image/jpeg",width:v,videoConstraints:m})]})},j=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,62)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;a(e),n(e),i(e),o(e),s(e)}))};r.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(b,{})}),document.getElementById("root")),j()}},[[61,1,2]]]);
//# sourceMappingURL=main.2429f2d1.chunk.js.map